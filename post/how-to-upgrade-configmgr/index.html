<!doctype html><html lang=en-us>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="How to Upgrade ConfigMgr">
<meta name=twitter:image content="https://ajf8729.com/icon.png">
<body class=not-ready data-menu=true>
<header class=header>
<p class=logo>
<a class=site-name href=https://ajf8729.com/>AJF8729</a><a class=btn-dark></a>
</p>
<script>let bodyClx=document.body.classList,btnDark=document.querySelector('.btn-dark'),sysDark=window.matchMedia('(prefers-color-scheme: dark)'),darkVal=localStorage.getItem('dark'),setDark=a=>{bodyClx[a?'add':'remove']('dark'),localStorage.setItem('dark',a?'yes':'no')};setDark(darkVal?darkVal==='yes':sysDark.matches),requestAnimationFrame(()=>bodyClx.remove('not-ready')),btnDark.addEventListener('click',()=>setDark(!bodyClx.contains('dark'))),sysDark.addEventListener('change',a=>setDark(a.matches))</script>
<nav class=menu>
<a href=/about/>About</a>
<a href=/resume/>Resume</a>
<a href=/lab-configuration/>Lab Configuration</a>
</nav>
<nav class=social>
<a class=twitter style=--url:url(./twitter.svg) href=https://twitter.com/ajf8729 target=_blank></a>
<a class=github style=--url:url(./github.svg) href=https://github.com/ajf8729 target=_blank></a>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-title>
<aside>
<time>September 7, 2021</time>
</aside>
<h1>How to Upgrade ConfigMgr</h1>
</header>
<section class=post-content><p>The following will show you how to upgrade a ConfigMgr site to the latest available update.</p>
<pre><code># Import the ConfigurationManager module
Import-Module -FullyQualifiedName &quot;$env:SMS_ADMIN_UI_PATH\..\ConfigurationManager.psd1&quot;
# Get the site code
$SiteCode = (Get-CimInstance -Namespace ROOT/SMS -ClassName SMS_ProviderLocation).SiteCode
# Change to the site psdrive
Set-Location -Path &quot;$($SiteCode):&quot;
# Find the latest update
$LatestSiteUpdate = (Get-CMSiteUpdate -Fast | Sort-Object -Property LastUpdateTime | Select-Object -First 1).Name
# Install the update
Install-CMSiteUpdate -Name $LatestSiteUpdate -Confirm:$false -Force
</code></pre>
<p>The above script also available on <a href=%5Bhttps://github.com/ajf8729/Toolbox/blob/main/ConfigMgr/Install-LatestSiteUpdate.ps1>GitHub</a>.</p>
</section>
<nav class=post-nav>
<a class=next href=https://ajf8729.com/post/part-ix-cm-rsp/><span>Part IX: ConfigMgr - Reporting Services Point Configuration</span><span>→</span></a>
</nav>
</article>
</main>
<footer class=footer>
<p>&copy; 2021 <a href=https://ajf8729.com/>AJF8729</a></p>
<p>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</p>
<p>
<a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper 5.0</a>
</p>
</footer>
</body>
</html>