<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>AJF8729</title><link>https://ajf8729.com/</link><description>Recent content on AJF8729</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 08 Sep 2021 16:14:37 -0400</lastBuildDate><atom:link href="https://ajf8729.com/index.xml" rel="self" type="application/rss+xml"/><item><title>Part X: ConfigMgr - Data Warehouse Service Point Configuration</title><link>https://ajf8729.com/guide/part-x-cm-dw/</link><pubDate>Wed, 08 Sep 2021 16:14:37 -0400</pubDate><guid>https://ajf8729.com/guide/part-x-cm-dw/</guid><description> Create Reporting Services Point account New-ADUser -Name svc_CM_DW -SamAccountName svc_CM_DW -CannotChangePassword $true -PasswordNeverExpires $true -Path &amp;quot;OU=CM,OU=Servers,OU=AJF8729,DC=ad,DC=ajf8729,DC=com&amp;quot; -AccountPassword (Read-Host -Prompt &amp;quot;Enter password&amp;quot; -AsSecureString) -KerberosEncryptionType AES128,AES256 -ChangePasswordAtLogon $false -DisplayName svc_CM_DW -Enabled $true -UserPrincipalName &amp;quot;svc_CM_DW@ad.ajf8729.com&amp;quot; -Description &amp;quot;ConfigMgr Data Warehouse Service Point Account&amp;quot; Install Reporting Services Point New-CMAccount -UserName &amp;quot;AD\svc_CM_DW&amp;quot; -Password (Read-Host -Prompt &amp;quot;Enter password&amp;quot; -AsSecureString) Add-CMDataWarehouseServicePoint -SiteSystemServerName adcm01.ad.ajf8729.com -DataWarehouseDatabaseServerName adcm01.ad.ajf8729.com -DataWarehouseDatabaseName CM_AD0_DW -DataWarehouseSqlPort 1433 -UserName &amp;quot;AD\svc_CM_DW&amp;quot;</description></item><item><title>How to Upgrade ConfigMgr</title><link>https://ajf8729.com/post/how-to-upgrade-configmgr/</link><pubDate>Tue, 07 Sep 2021 06:20:48 -0400</pubDate><guid>https://ajf8729.com/post/how-to-upgrade-configmgr/</guid><description>The following will show you how to upgrade a ConfigMgr site to the latest available update.
# Import the ConfigurationManager module Import-Module -FullyQualifiedName &amp;quot;$env:SMS_ADMIN_UI_PATH\..\ConfigurationManager.psd1&amp;quot; # Get the site code $SiteCode = (Get-CimInstance -Namespace ROOT/SMS -ClassName SMS_ProviderLocation).SiteCode # Change to the site psdrive Set-Location -Path &amp;quot;$($SiteCode):&amp;quot; # Find the latest update $LatestSiteUpdate = (Get-CMSiteUpdate -Fast | Sort-Object -Property LastUpdateTime | Select-Object -First 1).Name # Install the update Install-CMSiteUpdate -Name $LatestSiteUpdate -Confirm:$false -Force The above script also available on GitHub.</description></item><item><title>Part IX: ConfigMgr - Reporting Services Point Configuration</title><link>https://ajf8729.com/guide/part-ix-cm-rsp/</link><pubDate>Sat, 04 Sep 2021 15:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-ix-cm-rsp/</guid><description>Download SQL Server Reporting Services https://docs.microsoft.com/sql/reporting-services/install-windows/install-reporting-services https://www.microsoft.com/download/details.aspx?id=100122 Prepare gMSA for SSRS New-ADServiceAccount -Name svc_CM_SSRS -SamAccountName svc_CM_SSRS -DNSHostName adcm01.ad.ajf8729.com -KerberosEncryptionType AES128,AES256 -Path &amp;quot;OU=CM,OU=Servers,OU=AJF8729,DC=ad,DC=ajf8729,DC=com&amp;quot; -PrincipalsAllowedToRetrieveManagedPassword (Get-ADGroup -Identity CM_Servers) Install-ADServiceAccount -Identity svc_CM_SSRS Test-ADServiceAccount -Identity svc_CM_SSRS Restart-Computer Grant gMSA &amp;ldquo;Log on as a service&amp;rdquo; URA in ConfigMgr GPO Install SSRS SQLServerReportingServices.exe /passive /norestart /InstallFolder=&amp;quot;E:\Program Files\Microsoft SQL Server Reporting Services&amp;quot; /IAcceptLicenseTerms /Edition=Dev Configure SSRS Launch &amp;ldquo;Report Server Configuration Manager&amp;rdquo; Connect to the report server instance &amp;ldquo;SSRS&amp;rdquo; Configure the service account as AD\svc_CM_SSRS$ Configure the database, accepting all defaults Configure the Web Service URL Configure the Web Portal URL Verify URLs are accessible https://adcm01.</description></item><item><title>Part VIII: Active Directory Certificate Services</title><link>https://ajf8729.com/guide/part-viii-adcs/</link><pubDate>Wed, 01 Sep 2021 15:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-viii-adcs/</guid><description> Install enterprise root CA and web enrollment https://github.com/ajf8729/Lab/blob/main/11-Configure-ADCS.ps1 Configure templates Create endpoint template Duplicate &amp;ldquo;Workstation Authentication&amp;rdquo; template Duplicate &amp;ldquo;Kerberos Authentication&amp;rdquo; template Configure new templates for issuing Configure certificate autoenrollment GPO: lab.ajf8729.com Verify certificate enrollment on LABDC01A and LABCM01</description></item><item><title>Part VII: Patch My PC</title><link>https://ajf8729.com/guide/part-vii-pmpc/</link><pubDate>Wed, 01 Sep 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-vii-pmpc/</guid><description> Download current Patch My PC installer (2.0.9.0 as of 2021-09-01) https://patchmypc.com/msi Install Patch My PC msiexec.exe /i PatchMyPC-Publishing-Service.msi /qb Create folder for content New-Item -Path 'F:\' -Name &amp;quot;PMPC&amp;quot; -ItemType Directory | Out-Null Configure Patch My PC Enable &amp;ldquo;Limited trial mode&amp;rdquo; Enable preview builds Update to latest preview build (2.0.9.1 as of 2021-09-01) Enable creation of ConfigMgr apps Configure SMS Provider connection Set source folder to F:\PMPC Enable &amp;ldquo;Do not include the version name in the application name&amp;rdquo; Enable &amp;ldquo;Trigger software update point sync when new third party updates are published&amp;rdquo; Enable updates and ConfigMgr app for Firefox x64 Run publisher sync</description></item><item><title>Part VI: Azure AD - Configuration</title><link>https://ajf8729.com/guide/part-vi-aad-config/</link><pubDate>Tue, 31 Aug 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-vi-aad-config/</guid><description>Create domain &amp;ldquo;lab.ajf8729.com in DigitalOcean Configure domain &amp;ldquo;lab.ajf8729.com&amp;rdquo; in Azure AD https://github.com/ajf8729/Lab/blob/main/08-ConfigureAzureADDomain.ps1 Script will wait until DNS TXT record is created Configure LABDC01A for TLS 1.2 https://github.com/ajf8729/Lab/blob/main/09-ConfigureTLS1.2.ps1 Computer will automatically restart after 10 seconds Install Azure AD Connect on LABDC01A (2.0.10.0 as of 2021-08-31) https://www.microsoft.com/download/details.aspx?id=47594 msiexec.exe /i AzureADConnect.msi /qn Disable IE Enhanced Security Mode Set-ItemProperty -Path &amp;quot;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}&amp;quot; -Name &amp;quot;IsInstalled&amp;quot; -Value 0 Initial setup Move AADC related objects to T0 OU Get-ADGroup -Filter &amp;quot;Name -like 'ADSync*'&amp;quot; | Move-ADObject -TargetPath &amp;quot;OU=T0,DC=lab,DC=ajf8729,DC=com&amp;quot; Get-ADUser -Filter &amp;quot;Name -like 'MSOL_*'&amp;quot; | Move-ADObject -TargetPath &amp;quot;OU=T0,DC=lab,DC=ajf8729,DC=com&amp;quot; Get-ADServiceAccount -Filter &amp;quot;Name -like 'ADSync*'&amp;quot; | Move-ADObject -TargetPath &amp;quot;OU=T0,DC=lab,DC=ajf8729,DC=com&amp;quot; Customize synchronization options Configure hybrid join Configure device writeback Enable Seamless SSO https://github.</description></item><item><title>Part V: ConfigMgr - Configuration</title><link>https://ajf8729.com/guide/part-v-cm-config/</link><pubDate>Mon, 30 Aug 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-v-cm-config/</guid><description>Configure ConfigMgr site https://github.com/ajf8729/Lab/blob/main/04-ConfigureCM.ps1 Create OU-based collections https://github.com/ajf8729/Lab/blob/main/05-CreateOUCollectionStructure.ps1 Install CM client on LABCM01 &amp;quot;F:\Program Files\Microsoft Configuration Manager\Client\ccmsetup.exe&amp;quot; Configure Client Settings New-CMClientSetting -Name &amp;quot;LAB Default Client Settings&amp;quot; -Type Device New-CMClientSettingDeployment -Name &amp;quot;LAB Default Client Settings&amp;quot; -CollectionName &amp;quot;All Systems&amp;quot; Edit &amp;ldquo;LAB Default Client Settings&amp;rdquo; Computer Agent Organization name PowerShell execution policy Software Center Company name Color scheme Foreground color Disable &amp;ldquo;Hide installed applications&amp;rdquo; Enable &amp;ldquo;Hide Application Catalog&amp;rdquo; Software Updates Enable software updates Enable third party software updates Install/Configure Software Update Point https://github.</description></item><item><title>Part IV: ConfigMgr - Prerequisites &amp; Site Installation</title><link>https://ajf8729.com/guide/part-iv-cm-install/</link><pubDate>Sun, 29 Aug 2021 15:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-iv-cm-install/</guid><description>Create NO_SMS_ON_DRIVE.SMS files New-Item -Path 'C:\' -Name &amp;quot;NO_SMS_ON_DRIVE.SMS&amp;quot; -ItemType File | Out-Null New-Item -Path 'E:\' -Name &amp;quot;NO_SMS_ON_DRIVE.SMS&amp;quot; -ItemType File | Out-Null Install Windows features for Primary Site, Management Point, Distribution Point, State Migration Point, and Software Update Point roles https://github.com/ajf8729/Lab/blob/main/WindowsFeatures.txt Install-WindowsFeature -Name (Get-Content -Path &amp;quot;WindowsFeatures.txt&amp;quot;) Extend AD schema Copy ConfigMgr_ad_schema.ldf to DC Edit ConfigMgr_ad_schema.ldf Find/Replace all DC=x with DC=lab,DC=ajf8729,DC=com ldifde.</description></item><item><title>Part III: ConfigMgr - SQL Installation</title><link>https://ajf8729.com/guide/part-iii-cm-sql/</link><pubDate>Sun, 29 Aug 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-iii-cm-sql/</guid><description>Update DNS servers Set-DnsClientServerAddress -InterfaceAlias Ethernet -ServerAddresses @(&amp;quot;172.20.1.51&amp;quot;) Domain join Add-Computer -DomainName &amp;quot;lab.ajf8729.com&amp;quot; -Restart Configure disks Get-Disk | ?{$_.OperationalStatus -eq &amp;quot;Offline&amp;quot;} | Set-Disk -IsOffline $false Get-Disk | ?{$_.IsReadOnly -eq $true} | Initialize-Disk -PartitionStyle GPT New-Volume -DiskNumber 1 -FileSystem NTFS -DriveLetter &amp;quot;E&amp;quot; -FriendlyName &amp;quot;SQL&amp;quot; | Out-Null New-Volume -DiskNumber 2 -FileSystem NTFS -DriveLetter &amp;quot;F&amp;quot; -FriendlyName &amp;quot;CM&amp;quot; | Out-Null New-Item -Path &amp;quot;F:\&amp;quot; -Name &amp;quot;SOURCE&amp;quot; -ItemType Directory | Out-Null Install RSAT tools Install-WindowsFeature -Name RSAT-AD-PowerShell,RSAT-AD-AdminCenter,RSAT-ADDS-Tools,GPMC Install gMSA Install-ADServiceAccount -Identity &amp;quot;svc_CM_SQL&amp;quot; Restart-Computer Stage media Windows ADK https://docs.</description></item><item><title>Part II: Active Directory - Installation &amp; Configuration</title><link>https://ajf8729.com/guide/part-ii-ad-install-config/</link><pubDate>Sat, 28 Aug 2021 15:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-ii-ad-install-config/</guid><description> Install Active Directory https://github.com/ajf8729/Lab/blob/main/02-CreateAD.ps1 Configure Active Directory https://github.com/ajf8729/Lab/blob/main/03-ConfigureAD.ps1 Import security baselines https://aka.ms/securitybaselines Copy-Item -Path &amp;ldquo;C:\LAB\Windows-10-Windows Server-v20H2-Security-Baseline-FINAL\Templates*&amp;rdquo; -Destination &amp;ldquo;C:\Windows\SYSVOL\domain\Policies\PolicyDefinitions&amp;quot; -Recurse -Force Copy-Item -Path &amp;ldquo;C:\LAB\Windows-10-v21H1-Security-Baseline-FINAL\Templates*&amp;rdquo; -Destination &amp;ldquo;C:\Windows\SYSVOL\domain\Policies\PolicyDefinitions&amp;quot; -Recurse -Force C:\LAB\Windows-10-v21H1-Security-Baseline-FINAL\Scripts\Baseline-ADImport.ps1 C:\LAB\Windows-10-Windows Server-v20H2-Security-Baseline-FINAL\Scripts\Baseline-ADImport.ps1 https://github.com/ajf8729/Lab/blob/main/03a-SecurityBaselines.ps1 Configure GPOs Server - ConfigMgr User Rights Assignments &amp;ldquo;Lock pages in memory&amp;rdquo;: LAB\svc_CM_SQL$ &amp;ldquo;Log on as a service&amp;rdquo;: LAB\svc_CM_SQL$ Windows Firewall -&amp;gt; New inbound rule Custom All Programs Local TCP ports 1433, 4022 Any:Any, Allow, All profiles Name: &amp;ldquo;LAB - ConfigMgr - SQL&amp;rdquo; Server - Default Security Policy -&amp;gt; New local group preference Add LocalAdmin_Servers to Administrators Set group description to &amp;ldquo;GPO-Enforced Group&amp;rdquo; Enable &amp;ldquo;Delete all member users&amp;rdquo; and &amp;ldquo;Delete all member groups&amp;rdquo; Workstation - Default Security Policy -&amp;gt; New local group preference Add LocalAdmin_Workstations to Administrators Set group description to &amp;ldquo;GPO-Enforced Group&amp;rdquo; Enable &amp;ldquo;Delete all member users&amp;rdquo; and &amp;ldquo;Delete all member groups&amp;rdquo;</description></item><item><title>Part I: Initial VM Setup</title><link>https://ajf8729.com/guide/part-i-initial-vm-setup/</link><pubDate>Sat, 28 Aug 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/guide/part-i-initial-vm-setup/</guid><description>In Part I, we will build two virtual machines, one to serve as an Active Directory Domain Controller, and the other to server as a ConfigMgr primary site server.
Build VMs https://github.com/ajf8729/Lab/blob/main/01-BuildVMs.ps1 Start VMs and install Windows Server 2022 Datacenter GUI Set Administrator passwords and log in to VMs Configure hostnames LABDC01A: Rename-Computer -NewName LABDC01A LABCM01: Rename-Computer -NewName LABCM01 Configure IP addresses LABDC01A: New-NetIPAddress -InterfaceAlias Ethernet -AddressFamily IPv4 -IPAddress 172.</description></item><item><title>About</title><link>https://ajf8729.com/about/</link><pubDate>Tue, 24 Aug 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/about/</guid><description>Windows Sysadmin, focused on ConfigMgr, Intune, PowerShell, Active Directory, Azure AD, &amp;amp; Security. Administration team member for the WinAdmins Community.
This site is primarily for things related to my lab, please see AJF Tech Chatter for my production blog.</description></item><item><title>Resume</title><link>https://ajf8729.com/resume/</link><pubDate>Sat, 21 Aug 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/resume/</guid><description>Anthony J. Fontanez</description></item><item><title>Lab Configuration</title><link>https://ajf8729.com/lab-configuration/</link><pubDate>Fri, 20 Aug 2021 13:00:00 -0400</pubDate><guid>https://ajf8729.com/lab-configuration/</guid><description>&amp;ldquo;Internal&amp;rdquo; Network (172.20.1.0/24) 172.20.1.1 skynet Hyper-V Host 172.20.1.16 adcm01.ad.ajf8729.com ConfigMgr (AD0 Primary Site) 172.20.1.19 addc03a.ad.ajf8729.com Active Directory Domain Controller Azure AD Connect Certificate Authority AJF8729 SIGNING CA 2021 DFS Namespace Server DHCP Server DNS Server Intune Certificate Connector Intune Connector for Active Directory 172.20.1.71 labdc01a.lab.ajf8729.com Active Directory Domain Controller DNS Server 172.20.1.72 labcm01.lab.ajf8729.com ConfigMgr (LAB Primary Site) 172.</description></item></channel></rss>