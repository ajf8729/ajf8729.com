<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Guides on AJF8729</title><link>https://ajf8729.com/guide/</link><description>Recent content in Guides on AJF8729</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><atom:link href="https://ajf8729.com/guide/index.xml" rel="self" type="application/rss+xml"/><item><title>Active Directory Certificate Services</title><link>https://ajf8729.com/guide/active-directory-certificate-services/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/active-directory-certificate-services/</guid><description> Install AD CS roles Install-WindowsFeature -Name ADCS-Cert-Authority,ADCS-Web-Enrollment -IncludeManagementTools Create PKI A record Add-DnsServerResourceRecordA -Name pki -IPv4Address 172.20.1.101 -ZoneName lab.dev.ajf8729.com Configure enterprise subordinate certificate authority https://christopherkibble.com/posts/standing-up-a-microsoft-certificate-authority-part-2/ Configure CDP http://pki.lab.dev.ajf8729.com/CertEnroll/&amp;lt;CaName&amp;gt;&amp;lt;CRLNameSuffix&amp;gt;&amp;lt;DeltaCRLAllowed&amp;gt;.crl Include in CRL Include in CDP extension Configure AIA http://pki.lab.dev.ajf8729.com/CertEnroll/&amp;lt;ServerDNSName&amp;gt;_&amp;lt;CaName&amp;gt;&amp;lt;CertificateName&amp;gt;.crt Include in AIA extension Import root CA cert into domain root GPO Unpublish all currently published templates Configure &amp;ldquo;Kerberos Authentication&amp;rdquo; template Clone &amp;ldquo;Kerberos Authentication&amp;rdquo; template as &amp;ldquo;AJF8729 LAB Kerberos Authentication&amp;rdquo; Raise compatibility settings to maximum Cryptography settings: Provider category: KSP Algorithm: RSA Minimum key size: 2048 bit Cryptographic provider: Software KSP Hashing: SHA256 Subject name: DNS name SAN: DNS name Configure &amp;ldquo;Workstation Authentication&amp;rdquo; template Clone &amp;ldquo;Workstation Authentication&amp;rdquo; template as &amp;ldquo;AJF8729 LAB Workstation Authentication&amp;rdquo; Raise compatibility settings to maximum Cryptography settings: Provider category: KSP Algorithm: RSA Minimum key size: 2048 bit Cryptographic provider: Software KSP Hashing: SHA256 Subject name: DNS name SAN: DNS name Security: Domain Computers -&amp;gt; Add Autoenroll Configure &amp;ldquo;Web Server&amp;rdquo; template Clone &amp;ldquo;Web Server&amp;rdquo; template as &amp;ldquo;AJF8729 LAB Web Server&amp;rdquo; Raise compatibility settings to maximum Cryptography settings: Provider category: KSP Algorithm: RSA Minimum key size: 2048 bit Cryptographic provider: Software KSP Hashing: SHA256 Subject name: DNS name SAN: DNS name Security: Cert_WebServer -&amp;gt; Add Enroll, Autoenroll Enable new templates for enrollment Configure certificate autoenrollment settings in domain root GPO</description></item><item><title>Active Directory Domain Services - Installation and Configuration</title><link>https://ajf8729.com/guide/adds-installation-configuration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/adds-installation-configuration/</guid><description> Install Active Directory https://github.com/ajf8729/Lab/blob/main/02-CreateAD.ps1 Configure Active Directory https://github.com/ajf8729/Lab/blob/main/03-ConfigureAD.ps1 Import security baselines https://github.com/ajf8729/Lab/blob/main/03a-SecurityBaselines.ps1 Configure GPOs Server - ConfigMgr User Rights Assignments &amp;ldquo;Lock pages in memory&amp;rdquo;: LAB\svc_CM_SQL$ &amp;ldquo;Log on as a service&amp;rdquo;: LAB\svc_CM_SQL$ Windows Firewall -&amp;gt; New inbound rule Custom All Programs Local TCP ports 1433, 4022 Source: ConfigMgr Server IP Destination: ConfigMgr Server IP Allow All profiles Name: &amp;ldquo;ConfigMgr - SQL Traffic&amp;rdquo; Server - Default Security Policy -&amp;gt; New local group preference Add LocalAdmin_Servers to Administrators Set group description to &amp;ldquo;GPO-Enforced Group&amp;rdquo; Enable &amp;ldquo;Delete all member users&amp;rdquo; and &amp;ldquo;Delete all member groups&amp;rdquo; Workstation - Default Security Policy -&amp;gt; New local group preference Add LocalAdmin_Workstations to Administrators Set group description to &amp;ldquo;GPO-Enforced Group&amp;rdquo; Enable &amp;ldquo;Delete all member users&amp;rdquo; and &amp;ldquo;Delete all member groups&amp;rdquo;</description></item><item><title>Azure AD - Configuration</title><link>https://ajf8729.com/guide/azure-ad-configuration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/azure-ad-configuration/</guid><description>Create domain &amp;ldquo;dev.ajf8729.com in DigitalOcean Configure domain &amp;ldquo;dev.ajf8729.com&amp;rdquo; in Azure AD https://github.com/ajf8729/Lab/blob/main/08-ConfigureAzureADDomain.ps1 Script will wait until DNS TXT record is created Configure LABDC01A for TLS 1.2 https://github.com/ajf8729/Lab/blob/main/09-ConfigureTLS1.2.ps1 Computer will automatically restart after 10 seconds Install Azure AD Connect on LABDC01A (2.0.28.0 as of 2021-11-02) https://www.microsoft.com/download/details.aspx?id=47594 msiexec.exe /i AzureADConnect.msi /qn Disable IE Enhanced Security Mode Set-ItemProperty -Path &amp;quot;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}&amp;quot; -Name &amp;quot;IsInstalled&amp;quot; -Value 0 Initial setup Move AADC related objects to T0 OU Get-ADGroup -Filter &amp;quot;Name -like 'ADSync*'&amp;quot; | Move-ADObject -TargetPath &amp;quot;OU=T0,DC=lab,DC=dev,DC=ajf8729,DC=com&amp;quot; Get-ADUser -Filter &amp;quot;Name -like 'MSOL_*'&amp;quot; | Move-ADObject -TargetPath &amp;quot;OU=T0,DC=lab,DC=dev,DC=ajf8729,DC=com&amp;quot; Get-ADServiceAccount -Filter &amp;quot;Name -like 'ADSync*'&amp;quot; | Move-ADObject -TargetPath &amp;quot;OU=T0,DC=lab,DC=dev,DC=ajf8729,DC=com&amp;quot; Customize synchronization options Configure hybrid join Configure device writeback Enable Seamless SSO https://github.</description></item><item><title>ConfigMgr - Data Warehouse Service Point</title><link>https://ajf8729.com/guide/configmgr-data-warehouse-service-point/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/configmgr-data-warehouse-service-point/</guid><description> Create Reporting Services Point account New-ADUser -Name svc_CM_DW -SamAccountName svc_CM_DW -CannotChangePassword $true -PasswordNeverExpires $true -Path &amp;quot;OU=CM,OU=Servers,OU=AJF8729,DC=ad,DC=ajf8729,DC=com&amp;quot; -AccountPassword (Read-Host -Prompt &amp;quot;Enter password&amp;quot; -AsSecureString) -KerberosEncryptionType AES128,AES256 -ChangePasswordAtLogon $false -DisplayName svc_CM_DW -Enabled $true -UserPrincipalName &amp;quot;svc_CM_DW@ad.ajf8729.com&amp;quot; -Description &amp;quot;ConfigMgr Data Warehouse Service Point Account&amp;quot; Install Reporting Services Point New-CMAccount -UserName &amp;quot;AD\svc_CM_DW&amp;quot; -Password (Read-Host -Prompt &amp;quot;Enter password&amp;quot; -AsSecureString) Add-CMDataWarehouseServicePoint -SiteSystemServerName adcm01.ad.ajf8729.com -DataWarehouseDatabaseServerName adcm01.ad.ajf8729.com -DataWarehouseDatabaseName CM_AD0_DW -DataWarehouseSqlPort 1433 -UserName &amp;quot;AD\svc_CM_DW&amp;quot;</description></item><item><title>ConfigMgr - HTTPS Configuration</title><link>https://ajf8729.com/guide/configmgr-https-configuration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/configmgr-https-configuration/</guid><description> https://anthonyfontanez.com/index.php/2021/05/28/migrating-configmgr-to-https-only/ Configure &amp;ldquo;AJF8729 LAB ConfigMgr DP Client&amp;rdquo; certificate template Install Fallback Status Point Add-CMFallbackStatusPoint -SiteSystemServerName labcm01.lab.dev.ajf8729.com Configure IIS HTTPS bindings Enable certificate use when available Add root CA certificate to site Enable MP HTTPS Set-CMManagementPoint -SiteSystemServerName &amp;quot;labcm01.lab.dev.ajf8729.com&amp;quot; -EnableSsl $true Enable DP HTTPS Set-CMDistributionPoint -SiteSystemServerName &amp;quot;labcm01.lab.dev.ajf8729.com&amp;quot; -ClientCommunicationType Https -CertificatePath &amp;quot;C:\LAB\AJF8729 LAB ConfigMgr DP Client 2021.11.03.pfx&amp;quot; -CertificatePassword (Read-Host -Prompt &amp;quot;Enter PFX Password&amp;quot; -AsSecureString) Verify communication Set site to HTTPS-only Set-CMSite -SiteCode LAB -ClientComputerCommunicationType HttpsOnly</description></item><item><title>ConfigMgr - Prerequisites and Site Installation</title><link>https://ajf8729.com/guide/configmgr-prerequisites-site-installation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/configmgr-prerequisites-site-installation/</guid><description>Create NO_SMS_ON_DRIVE.SMS files New-Item -Path 'C:\' -Name &amp;quot;NO_SMS_ON_DRIVE.SMS&amp;quot; -ItemType File | Out-Null New-Item -Path 'E:\' -Name &amp;quot;NO_SMS_ON_DRIVE.SMS&amp;quot; -ItemType File | Out-Null Install Windows features for Primary Site, Management Point, Distribution Point, State Migration Point, and Software Update Point roles https://github.com/ajf8729/Lab/blob/main/WindowsFeatures.txt Install-WindowsFeature -Name (Get-Content -Path &amp;quot;WindowsFeatures.txt&amp;quot;) Extend AD schema Copy ConfigMgr_ad_schema.ldf to DC Edit ConfigMgr_ad_schema.ldf Find/Replace all DC=x with DC=lab,DC=dev,DC=ajf8729,DC=com ldifde.</description></item><item><title>ConfigMgr - Reporting Services Point</title><link>https://ajf8729.com/guide/configmgr-reporting-services-point/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/configmgr-reporting-services-point/</guid><description>Download SQL Server Reporting Services https://docs.microsoft.com/sql/reporting-services/install-windows/install-reporting-services https://www.microsoft.com/download/details.aspx?id=100122 Prepare gMSA for SSRS New-ADServiceAccount -Name svc_CM_SSRS -SamAccountName svc_CM_SSRS -DNSHostName adcm01.ad.ajf8729.com -KerberosEncryptionType AES128,AES256 -Path &amp;quot;OU=CM,OU=Servers,OU=AJF8729,DC=ad,DC=ajf8729,DC=com&amp;quot; -PrincipalsAllowedToRetrieveManagedPassword (Get-ADGroup -Identity CM_Servers) Install-ADServiceAccount -Identity svc_CM_SSRS Test-ADServiceAccount -Identity svc_CM_SSRS Restart-Computer Grant gMSA &amp;ldquo;Log on as a service&amp;rdquo; URA in ConfigMgr GPO Install SSRS SQLServerReportingServices.exe /passive /norestart /InstallFolder=&amp;quot;E:\Program Files\Microsoft SQL Server Reporting Services&amp;quot; /IAcceptLicenseTerms /Edition=Dev Configure SSRS Launch &amp;ldquo;Report Server Configuration Manager&amp;rdquo; Connect to the report server instance &amp;ldquo;SSRS&amp;rdquo; Configure the service account as AD\svc_CM_SSRS$ Configure the database, accepting all defaults Configure the Web Service URL Configure the Web Portal URL Verify URLs are accessible https://adcm01.</description></item><item><title>ConfigMgr - Site Configuration</title><link>https://ajf8729.com/guide/configmgr-site-configuration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/configmgr-site-configuration/</guid><description>Configure ConfigMgr site https://github.com/ajf8729/Lab/blob/main/04-ConfigureCM.ps1 Create OU-based collections https://github.com/ajf8729/Lab/blob/main/05-CreateOUCollectionStructure.ps1 Install CM client on LABCM01 &amp;quot;F:\Program Files\Microsoft Configuration Manager\Client\ccmsetup.exe&amp;quot; Configure Client Settings New-CMClientSetting -Name &amp;quot;LAB Default Client Settings&amp;quot; -Type Device New-CMClientSettingDeployment -Name &amp;quot;LAB Default Client Settings&amp;quot; -CollectionName &amp;quot;All Systems&amp;quot; Edit &amp;ldquo;LAB Default Client Settings&amp;rdquo; Computer Agent Organization name PowerShell execution policy Software Center Company name Color scheme Foreground color Disable &amp;ldquo;Hide installed applications&amp;rdquo; Enable &amp;ldquo;Hide Application Catalog&amp;rdquo; Software Updates Enable software updates Enable third party software updates Install/Configure Software Update Point https://github.</description></item><item><title>ConfigMgr - SQL Installation and Configuration</title><link>https://ajf8729.com/guide/configmgr-sql-installation-configuration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/configmgr-sql-installation-configuration/</guid><description>Update DNS servers Set-DnsClientServerAddress -InterfaceAlias Ethernet -ServerAddresses @(&amp;quot;172.20.1.51&amp;quot;) Domain join Add-Computer -DomainName &amp;quot;lab.ajf8729.com&amp;quot; -Restart Configure disks Get-Disk | ?{$_.OperationalStatus -eq &amp;quot;Offline&amp;quot;} | Set-Disk -IsOffline $false Get-Disk | ?{$_.IsReadOnly -eq $true} | Initialize-Disk -PartitionStyle GPT New-Volume -DiskNumber 1 -FileSystem NTFS -DriveLetter &amp;quot;E&amp;quot; -FriendlyName &amp;quot;SQL&amp;quot; | Out-Null New-Volume -DiskNumber 2 -FileSystem NTFS -DriveLetter &amp;quot;F&amp;quot; -FriendlyName &amp;quot;CM&amp;quot; | Out-Null New-Item -Path &amp;quot;F:\&amp;quot; -Name &amp;quot;SOURCE&amp;quot; -ItemType Directory | Out-Null Install RSAT tools Install-WindowsFeature -Name RSAT-AD-PowerShell,RSAT-AD-AdminCenter,RSAT-ADDS-Tools,GPMC Install gMSA Install-ADServiceAccount -Identity &amp;quot;svc_CM_SQL&amp;quot; Restart-Computer Stage media Windows ADK https://docs.</description></item><item><title>Patch My PC</title><link>https://ajf8729.com/guide/patch-my-pc/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/patch-my-pc/</guid><description> Download current Patch My PC installer (2.0.9.0 as of 2021-09-01) https://patchmypc.com/msi Install Patch My PC msiexec.exe /i PatchMyPC-Publishing-Service.msi /qb Create folder for content New-Item -Path 'F:\' -Name &amp;quot;PMPC&amp;quot; -ItemType Directory | Out-Null Configure Patch My PC Enable &amp;ldquo;Limited trial mode&amp;rdquo; Enable preview builds Update to latest preview build (2.0.9.1 as of 2021-09-01) Enable creation of ConfigMgr apps Configure SMS Provider connection Set source folder to F:\PMPC Enable &amp;ldquo;Do not include the version name in the application name&amp;rdquo; Enable &amp;ldquo;Trigger software update point sync when new third party updates are published&amp;rdquo; Enable updates and ConfigMgr app for Firefox x64 Run publisher sync</description></item><item><title>VM Creation</title><link>https://ajf8729.com/guide/vm-creation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/vm-creation/</guid><description>Build VMs https://github.com/ajf8729/Lab/blob/main/01-BuildVMs.ps1 Start VMs and install Windows Server 2022 Datacenter GUI Set Administrator passwords and log in to VMs Configure hostnames LABDC01A: Rename-Computer -NewName LABDC01A LABCM01: Rename-Computer -NewName LABCM01 Configure IP addresses LABDC01A: New-NetIPAddress -InterfaceAlias Ethernet -AddressFamily IPv4 -IPAddress 172.20.1.51 -PrefixLength 24 -DefaultGateway 172.20.1.1 LABCM01: New-NetIPAddress -InterfaceAlias Ethernet -AddressFamily IPv4 -IPAddress 172.20.1.52 -PrefixLength 24 -DefaultGateway 172.20.1.1 Configure DNS servers Set-DnsClientServerAddress -InterfaceAlias Ethernet -ServerAddresses @(&amp;quot;172.</description></item><item><title>Windows Hello for Business</title><link>https://ajf8729.com/guide/windows-hello-for-business/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://ajf8729.com/guide/windows-hello-for-business/</guid><description> Configure Hybrid Azure AD Key Trust https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-hybrid-key-trust</description></item></channel></rss>